<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es"><head>
<style class="darkreader darkreader--fallback" media="screen"></style><style class="darkreader darkreader--text" media="screen"></style><style class="darkreader darkreader--invert" media="screen">.jfk-bubble.gtx-bubble, .captcheck_answer_label &gt; input + img, span#closed_text &gt; img[src^="https://www.gstatic.com/images/branding/googlelogo"], span[data-href^="https://www.hcaptcha.com/"] &gt; #icon, img.Wirisformula, a[data-testid="headerMediumLogo"]&gt;svg, .d2l-navigation-link-image-container, .d2l-iframe-loading-container {
    filter: invert(100%) hue-rotate(180deg) contrast(90%) !important;
}</style><style class="darkreader darkreader--inline" media="screen">[data-darkreader-inline-bgcolor] {
  background-color: var(--darkreader-inline-bgcolor) !important;
}
[data-darkreader-inline-bgimage] {
  background-image: var(--darkreader-inline-bgimage) !important;
}
[data-darkreader-inline-border] {
  border-color: var(--darkreader-inline-border) !important;
}
[data-darkreader-inline-border-bottom] {
  border-bottom-color: var(--darkreader-inline-border-bottom) !important;
}
[data-darkreader-inline-border-left] {
  border-left-color: var(--darkreader-inline-border-left) !important;
}
[data-darkreader-inline-border-right] {
  border-right-color: var(--darkreader-inline-border-right) !important;
}
[data-darkreader-inline-border-top] {
  border-top-color: var(--darkreader-inline-border-top) !important;
}
[data-darkreader-inline-boxshadow] {
  box-shadow: var(--darkreader-inline-boxshadow) !important;
}
[data-darkreader-inline-color] {
  color: var(--darkreader-inline-color) !important;
}
[data-darkreader-inline-fill] {
  fill: var(--darkreader-inline-fill) !important;
}
[data-darkreader-inline-stroke] {
  stroke: var(--darkreader-inline-stroke) !important;
}
[data-darkreader-inline-outline] {
  outline-color: var(--darkreader-inline-outline) !important;
}
[data-darkreader-inline-stopcolor] {
  stop-color: var(--darkreader-inline-stopcolor) !important;
}
[data-darkreader-inline-bg] {
  background: var(--darkreader-inline-bg) !important;
}
[data-darkreader-inline-border-short] {
  border: var(--darkreader-inline-border-short) !important;
}
[data-darkreader-inline-border-bottom-short] {
  border-bottom: var(--darkreader-inline-border-bottom-short) !important;
}
[data-darkreader-inline-border-left-short] {
  border-left: var(--darkreader-inline-border-left-short) !important;
}
[data-darkreader-inline-border-right-short] {
  border-right: var(--darkreader-inline-border-right-short) !important;
}
[data-darkreader-inline-border-top-short] {
  border-top: var(--darkreader-inline-border-top-short) !important;
}
[data-darkreader-inline-invert] {
    filter: invert(100%) hue-rotate(180deg);
}</style><style class="darkreader darkreader--variables" media="screen">:root {
   --darkreader-neutral-background: var(--darkreader-background-ffffff, #181a1b);
   --darkreader-neutral-text: var(--darkreader-text-000000, #e8e6e3);
   --darkreader-selection-background: var(--darkreader-background-0060d4, #004daa);
   --darkreader-selection-text: var(--darkreader-text-ffffff, #e8e6e3);
}</style><style class="darkreader darkreader--root-vars" media="screen"></style><style class="darkreader darkreader--user-agent" media="screen">@layer {
html {
    background-color: var(--darkreader-background-ffffff, #181a1b) !important;
}
html {
    color-scheme: dark !important;
}
iframe {
    color-scheme: dark !important;
}
html, body {
    background-color: var(--darkreader-background-ffffff, #181a1b);
}
html, body {
    border-color: var(--darkreader-border-4c4c4c, #736b5e);
    color: var(--darkreader-text-000000, #e8e6e3);
}
a {
    color: var(--darkreader-text-0040ff, #3391ff);
}
table {
    border-color: var(--darkreader-border-808080, #545b5e);
}
mark {
    color: var(--darkreader-text-000000, #e8e6e3);
}
::placeholder {
    color: var(--darkreader-text-a9a9a9, #b2aba1);
}
input:-webkit-autofill,
textarea:-webkit-autofill,
select:-webkit-autofill {
    background-color: var(--darkreader-background-faffbd, #404400) !important;
    color: var(--darkreader-text-000000, #e8e6e3) !important;
}
::selection {
    background-color: var(--darkreader-background-0060d4, #004daa) !important;
    color: var(--darkreader-text-ffffff, #e8e6e3) !important;
}
::-moz-selection {
    background-color: var(--darkreader-background-0060d4, #004daa) !important;
    color: var(--darkreader-text-ffffff, #e8e6e3) !important;
}
}</style>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mi Dashboard Personal</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&amp;family=Roboto:wght@400;500&amp;display=swap" rel="stylesheet" />
    <!-- Font Awesome para iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer" /><style class="darkreader darkreader--sync" media="screen"></style>

    <style>
       body {
            font-family: 'Roboto', sans-serif;
            background-color: #f4f4f4;
            color: #333;
            margin: 0;
            padding: 0;
            line-height: 1.6;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .container {
            max-width: 95%;
            margin: 0 auto;
            padding: 20px;
            flex: 1;
            width: 100%;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-family: 'Poppins', sans-serif;
            font-size: 2.5rem;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #7f8c8d;
            font-size: 1.1rem;
        }

        .buttons {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 30px;
        }

        .btn {
            padding: 12px 25px;
            font-family: 'Poppins', sans-serif;
            font-size: 1rem;
            font-weight: 600;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            text-decoration: none;
            color: white;
            width: auto;
            min-width: 120px;
        }

        .btn-primary { background-color: #3498db; }
        .btn-secondary { background-color: #2ecc71; }
        .btn-download { background-color: #e67e22; }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
        }

        .bookmarks-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }

        .category {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            transition: transform 0.2s ease;
        }

        .category:hover {
            transform: translateY(-5px);
        }

        .category-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            color: white;
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
        }

        .add-icon {
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            transition: background-color: 0.3s;
        }

        .add-icon:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .bookmark-list {
            padding: 10px;
        }

        .bookmark {
            display: flex;
            align-items: center;
            padding: 10px;
            text-decoration: none;
            color: #333;
            border-radius: 5px;
            transition: background-color: 0.3s;
        }

        .bookmark:hover {
            background-color: #f0f0f0;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            padding: 20px;
            width: 90%;
            max-width: 600px;
            position: relative;
        }

        .close {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 24px;
            cursor: pointer;
            color: #999;
        }

        .close:hover {
            color: #333;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .form-group input[type="text"],
        .form-group input[type="url"],
        .form-group input[type="color"],
        .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }

        .form-group select {
            cursor: pointer;
        }

        .btn-add {
            width: 100%;
            background-color: #27ae60;
            margin-top: 10px;
        }

        .category-item,
        .bookmark-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 5px;
            border-bottom: 1px solid #eee;
        }

        .category-actions button,
        .bookmark-actions button {
            margin-left: 5px;
            padding: 5px 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            color: white;
            background-color: #3498db;
        }

        .category-actions button:nth-child(2),
        .bookmark-actions button:nth-child(2) {
            background-color: #e74c3c;
        }

        .category-actions button:nth-child(3),
        .category-actions button:nth-child(4) {
            background-color: #7f8c8d;
        }

        .footer {
            text-align: center;
            padding: 20px;
            margin-top: auto;
            color: #777;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .buttons {
                flex-direction: column;
            }
            .modal-content {
                width: 95%;
            }
        }


        @media (max-width: 576px) {
            .header h1{
              font-size: 2rem;
            }

            .btn {
                padding: 10px 15px;
                font-size: 0.9rem;
            }
        }
    </style><style class="darkreader darkreader--sync" media="screen"></style>
<meta name="darkreader" content="17fee521d28b4584949e27d234015c88" /><style class="darkreader darkreader--override" media="screen">.vimvixen-hint {
    background-color: var(--darkreader-background-ffd76e, #684b00) !important;
    border-color: var(--darkreader-background-c59d00, #9e7e00) !important;
    color: var(--darkreader-text-302505, #d7d4cf) !important;
}
#vimvixen-console-frame {
    color-scheme: light !important;
}
::placeholder {
    opacity: 0.5 !important;
}
#edge-translate-panel-body,
.MuiTypography-body1,
.nfe-quote-text {
    color: var(--darkreader-neutral-text) !important;
}
gr-main-header {
    background-color: var(--darkreader-background-add8e6, #1b4958) !important;
}
.tou-z65h9k,
.tou-mignzq,
.tou-1b6i2ox,
.tou-lnqlqk {
    background-color: var(--darkreader-neutral-background) !important;
}
.tou-75mvi {
    background-color: var(--darkreader-background-cfecf5, #0f3a47) !important;
}
.tou-ta9e87,
.tou-1w3fhi0,
.tou-1b8t2us,
.tou-py7lfi,
.tou-1lpmd9d,
.tou-1frrtv8,
.tou-17ezmgn {
    background-color: var(--darkreader-background-f5f5f5, #1e2021) !important;
}
.tou-uknfeu {
    background-color: var(--darkreader-background-faedda, #432c09) !important;
}
.tou-6i3zyv {
    background-color: var(--darkreader-background-85c3d8, #245d70) !important;
}
div.mermaid-viewer-control-panel .btn {
    background-color: var(--darkreader-neutral-background);
    fill: var(--darkreader-neutral-text);
}
svg g rect.er {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.entityBox {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.attributeBoxOdd {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.er.attributeBoxEven {
    fill: var(--darkreader-selection-background);
    fill-opacity: 0.8 !important;
}
svg rect.er.relationshipLabelBox {
    fill: var(--darkreader-neutral-background) !important;
}
svg g g.nodes rect,
svg g g.nodes polygon {
    fill: var(--darkreader-neutral-background) !important;
}
svg g rect.task {
    fill: var(--darkreader-selection-background) !important;
}
svg line.messageLine0,
svg line.messageLine1 {
    stroke: var(--darkreader-neutral-text) !important;
}
div.mermaid .actor {
    fill: var(--darkreader-neutral-background) !important;
}
mitid-authenticators-code-app &gt; .code-app-container {
    background-color: white !important;
    padding-top: 1rem;
}
iframe#unpaywall[src$="unpaywall.html"] {
    color-scheme: light !important;
}
select option {
    background-color: var(--darkreader-neutral-background) !important;
}
body#tumblr {
    --darkreader-bg--secondary-accent: 31, 32, 34 !important;
    --darkreader-bg--white: 23, 23, 23 !important;
    --darkreader-text--black: 228, 224, 218 !important;
}
:host {
    --d2l-border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
    --d2l-button-icon-background-color-hover: var(--darkreader-bg--d2l-color-gypsum) !important;
    --d2l-color-ferrite: var(--darkreader-neutral-text) !important;
    --d2l-color-sylvite: var(--darkreader-bg--d2l-color-sylvite) !important;
    --d2l-dropdown-background-color: var(--darkreader-neutral-background) !important;
    --d2l-dropdown-border-color: var(--darkreader-border--d2l-color-mica) !important;
    --d2l-input-backgroud-color: var(--darkreader-neutral-background) !important;
    --d2l-menu-border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
    --d2l-tooltip-background-color: var(--darkreader-neutral-background) !important;
    --d2l-tooltip-border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
}
:host([_floating]) .d2l-floating-buttons-container {
    background-color: var(--darkreader-neutral-background) !important;
    border-top-color: var(--darkreader-border--d2l-color-mica) !important;
    opacity: 0.88 !important;
}
d2l-card {
    background: var(--darkreader-neutral-background) !important;
    border-color: var(--darkreader-border--d2l-color-gypsum) !important;
}
d2l-dropdown-content &gt; div,
d2l-menu-item {
    background-color: var(--darkreader-neutral-background) !important;
    border-radius: 10px !important;
}
d2l-empty-state-simple {
    border-color: var(--darkreader-bg--d2l-color-gypsum) !important;
}
.d2l-button-filter &gt; ul &gt; li &gt; a.vui-button {
    border-color: var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-label-text:has(.d2l-button-subtle-content):hover,
.d2l-label-text:has(.d2l-button-subtle-content):focus,
.d2l-label-text:has(.d2l-button-subtle-content):active {
    background-color: var(--darkreader-bg--d2l-color-gypsum) !important;
}
.d2l-navigation-centerer {
    color: inherit !important;
}
.d2l-tabs-layout {
    border-color: var(--darkreader-border--d2l-color-gypsum) !important;
}
.d2l-input,
.d2l-calendar-date,
.d2l-htmleditor-container {
    background-color: var(--darkreader-neutral-background) !important;
}
.d2l-collapsible-panel {
    border: 1px solid var(--darkreader-border--d2l-color-mica) !important;
    border-radius: 0.4rem !important;
}
.d2l-collapsible-panel-divider {
    border-bottom: 1px solid var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-w2d-flex {
    border-bottom: 2px solid var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-collapsible-panel scrolled,
.d2l-collapsible-panel-header,
.d2l-w2d-collection-fixed {
    background-color: var(--darkreader-neutral-background) !important;
}
.d2l-loading-spinner-bg {
    fill: var(--darkreader-bg--d2l-color-gypsum) !important;
}
.d2l-loading-spinner-bg-stroke {
    stroke: var(--darkreader-border--d2l-color-mica) !important;
}
.d2l-loading-spinner-wrapper svg path,
.d2l-loading-spinner-wrapper svg circle {
    fill: var(--darkreader-neutral-background) !important;
}
embed[type="application/pdf"] { filter: invert(100%) contrast(90%); }</style>
</head>
<body>
<div class="container">
    <header class="header">
        <h1><i class="fas fa-tachometer-alt"></i> Mi Dashboard Personal</h1>
        <p class="subtitle">Organiza tus enlaces favoritos</p>
    </header>
    <div class="buttons">
        <button class="btn btn-primary" onclick="openCategoryManagerModal()"><i class="fas fa-folder-plus"></i> Gestionar Categorías</button>
        <button class="btn btn-secondary" onclick="openBookmarkManagerModal()"><i class="fas fa-bookmark"></i> Gestionar Marcadores</button>
        <button class="btn btn-download" onclick="downloadUpdatedHTML()"><i class="fas fa-download"></i> Descargar HTML</button>
    </div>
    <main id="bookmarksGrid" class="bookmarks-grid">
          <div class="category" data-category="Periódicos">
              <div class="category-header" style="background: linear-gradient(45deg, #f4b400, #e0a000); ">
                  <span>Periódicos</span>
                  <div class="add-icon" onclick="openNewBookmarkModal('Periódicos')">
                      <i class="fas fa-plus"></i>
                  </div>
              </div>
              <div class="bookmark-list"><a href="https://elcorreo.com" class="bookmark" target="_blank">El Correo Digital</a><a href="https://elpais.com" class="bookmark" target="_blank">El País</a></div>
          </div>
          <div class="category" data-category="Viajes">
              <div class="category-header" style="background: linear-gradient(45deg, #e67e22, #d26a0e); ">
                  <span>Viajes</span>
                  <div class="add-icon" onclick="openNewBookmarkModal('Viajes')">
                      <i class="fas fa-plus"></i>
                  </div>
              </div>
              <div class="bookmark-list"><a href="https://booking.com" class="bookmark" target="_blank">Booking.com</a></div>
          </div>
          <div class="category" data-category="Redes Sociales y Comunicación">
              <div class="category-header" style="background: linear-gradient(45deg, #ff6f61, #eb5b4d); ">
                  <span>Redes Sociales y Comunicación</span>
                  <div class="add-icon" onclick="openNewBookmarkModal('Redes Sociales y Comunicación')">
                      <i class="fas fa-plus"></i>
                  </div>
              </div>
              <div class="bookmark-list"><a href="https://youtube.com" class="bookmark" target="_blank">YouTube</a><a href="https://whatsapp.com" class="bookmark" target="_blank">WhatsApp</a><a href="https://twitch.tv" class="bookmark" target="_blank">Twitch</a></div>
          </div>
          <div class="category" data-category="IA y Productividad">
              <div class="category-header" style="background: linear-gradient(45deg, #00c4b4, #00b0a0); ">
                  <span>IA y Productividad</span>
                  <div class="add-icon" onclick="openNewBookmarkModal('IA y Productividad')">
                      <i class="fas fa-plus"></i>
                  </div>
              </div>
              <div class="bookmark-list"><a href="https://mail.google.com" class="bookmark" target="_blank">Gmail</a><a href="https://chat.openai.com" class="bookmark" target="_blank">ChatGPT</a><a href="https://gemini.google.com" class="bookmark" target="_blank">Gemini</a><a href="https://claude.ai" class="bookmark" target="_blank">Claude</a><a href="https://canva.com" class="bookmark" target="_blank">Canva</a></div>
          </div>
          <div class="category" data-category="No Mans Sky">
              <div class="category-header" style="background: linear-gradient(45deg, #7b1fa2, #670b8e); ">
                  <span>No Mans Sky</span>
                  <div class="add-icon" onclick="openNewBookmarkModal('No Mans Sky')">
                      <i class="fas fa-plus"></i>
                  </div>
              </div>
              <div class="bookmark-list"><a href="https://nomansskyrecipes.com" class="bookmark" target="_blank">NMS Recipes</a><a href="https://cwmonkey.github.io/nms-expeditions" class="bookmark" target="_blank">NMS Expeditions</a></div>
          </div>
          <div class="category" data-category="Google">
              <div class="category-header" style="background: linear-gradient(45deg, #4285f4, #2e71e0); ">
                  <span>Google</span>
                  <div class="add-icon" onclick="openNewBookmarkModal('Google')">
                      <i class="fas fa-plus"></i>
                  </div>
              </div>
              <div class="bookmark-list"><a href="https://mail.google.com" class="bookmark" target="_blank">Gmail</a><a href="https://drive.google.com" class="bookmark" target="_blank">Drive</a><a href="https://keep.google.com" class="bookmark" target="_blank">Keep</a><a href="https://docs.google.com" class="bookmark" target="_blank">Docs</a><a href="https://sheets.google.com" class="bookmark" target="_blank">Sheets</a></div>
          </div></main>
</div>
<footer class="footer">
    <p>Creado por ElVarto7 - 2025</p>
</footer>

<script>
        document.addEventListener('DOMContentLoaded', () =&gt; {
            loadCategories();
            renderCategories();
            renderBookmarkCategoryList();
        });

        let categories = [];
        let selectedCategoryName = null;
        let selectedCategoryForBookmarks = null;

        const defaultCategories = [
            { id: 1, name: "Trabajo", color: "#3498db", bookmarks: [{ title: "Gmail Corporativo", url: "https://mail.google.com" }] },
            { id: 2, name: "Viajes", color: "#e67e22", bookmarks: [{ title: "Booking.com", url: "https://booking.com" }] },
            { id: 3, name: "Redes Sociales y Comunicación", color: "#ff6f61", bookmarks: [{ title: "YouTube", url: "https://youtube.com" }, { title: "WhatsApp", url: "https://whatsapp.com" }, { title: "Twitch", url: "https://twitch.tv" }] },
            { id: 4, name: "IA y Productividad", color: "#00c4b4", bookmarks: [{ title: "Gmail", url: "https://mail.google.com" }, { title: "ChatGPT", url: "https://chat.openai.com" }, { title: "Gemini", url: "https://gemini.google.com" }, { title: "Claude", url: "https://claude.ai" }, { title: "Canva", url: "https://canva.com" }] },
            { id: 5, name: "No Mans Sky", color: "#7b1fa2", bookmarks: [{ title: "NMS Recipes", url: "https://nomansskyrecipes.com" }, { title: "NMS Expeditions", url: "https://cwmonkey.github.io/nms-expeditions" }] },
            { id: 6, name: "Google", color: "#4285f4", bookmarks: [{ title: "Gmail", url: "https://mail.google.com" }, { title: "Drive", url: "https://drive.google.com" }, { title: "Keep", url: "https://keep.google.com" }, { title: "Docs", url: "https://docs.google.com" }, { title: "Sheets", url: "https://sheets.google.com" }] },
            { id: 7, name: "Periódicos", color: "#f4b400", bookmarks: [{ title: "El Correo Digital", url: "https://elcorreo.com" }, { title: "El País", url: "https://elpais.com" }]},
        ];

        function loadCategories() {
            const storedCategories = localStorage.getItem('categories');
            categories = storedCategories ? JSON.parse(storedCategories) : JSON.parse(JSON.stringify(defaultCategories));
            syncCategoriesWithDefault();
            saveCategories();
        }

        function syncCategoriesWithDefault() {
            const defaultMap = new Map(defaultCategories.map(cat =&gt; [cat.id, cat]));
            defaultCategories.forEach(defaultCat =&gt; {
                const existingIndex = categories.findIndex(cat =&gt; cat.id === defaultCat.id);
                if (existingIndex !== -1) {
                    const existingCat = categories[existingIndex];
                    existingCat.name = defaultCat.name;
                    existingCat.color = defaultCat.color;
                    const defaultBookmarksMap = new Map(defaultCat.bookmarks.map(b =&gt; [b.url, b]));
                    const updatedBookmarks = [...defaultCat.bookmarks];
                    existingCat.bookmarks.forEach(bookmark =&gt; {
                        if (!defaultBookmarksMap.has(bookmark.url)) {
                            updatedBookmarks.push(bookmark);
                        }
                    });
                    existingCat.bookmarks = updatedBookmarks;
                } else {
                    categories.push(JSON.parse(JSON.stringify(defaultCat)));
                }
            });
            categories = categories.filter(cat =&gt; defaultMap.has(cat.id));
        }

        function saveCategories() {
            localStorage.setItem('categories', JSON.stringify(categories));
        }

        function renderCategories() {
            const grid = document.getElementById('bookmarksGrid');
            if (!grid) return;
            grid.innerHTML = '';

            categories.forEach(category =&gt; {
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'category';
                categoryDiv.setAttribute('data-category', category.name);

                const header = document.createElement('div');
                header.className = 'category-header';
                header.style.background = `linear-gradient(45deg, ${category.color}, ${adjustColor(category.color, -20)})`;
                header.innerHTML = `
                    &lt;span&gt;${category.name}&lt;/span&gt;
                    &lt;div class="add-icon" onclick="openNewBookmarkModal('${category.name}')"&gt;
                        &lt;i class="fas fa-plus"&gt;&lt;/i&gt;
                    &lt;/div&gt;
                `;
                categoryDiv.appendChild(header);

                const bookmarkList = document.createElement('div');
                bookmarkList.className = 'bookmark-list';
                category.bookmarks.forEach(bookmark =&gt; {
                    const a = document.createElement('a');
                    a.href = bookmark.url;
                    a.className = 'bookmark';
                    a.target = '_blank';
                    a.textContent = bookmark.title;
                    bookmarkList.appendChild(a);
                });
                categoryDiv.appendChild(bookmarkList);
                grid.appendChild(categoryDiv);
            });
        }

        function renderCategoryManagementList() {
            const list = document.getElementById('categoriesList');
            if (!list) return;
            list.innerHTML = '';
            categories.forEach((category, index) =&gt; {
                const item = document.createElement('div');
                item.className = 'category-item';
                item.innerHTML = `
                    &lt;span&gt;${category.name}&lt;/span&gt;
                    &lt;div class="category-actions"&gt;
                        &lt;button onclick="editCategory(${index})"&gt;&lt;i class="fas fa-edit"&gt;&lt;/i&gt;&lt;/button&gt;
                        &lt;button onclick="deleteCategory(${index})"&gt;&lt;i class="fas fa-trash-alt"&gt;&lt;/i&gt;&lt;/button&gt;
                        &lt;button onclick="moveCategoryUp(${index})"&gt;&lt;i class="fas fa-arrow-up"&gt;&lt;/i&gt;&lt;/button&gt;
                        &lt;button onclick="moveCategoryDown(${index})"&gt;&lt;i class="fas fa-arrow-down"&gt;&lt;/i&gt;&lt;/button&gt;
                    &lt;/div&gt;
                `;
                list.appendChild(item);
            });
        }

        function openCategoryManagerModal() {
            renderCategoryManagementList();
            document.getElementById('categoryManagerModal').style.display = 'flex';
        }

        function closeCategoryManagerModal() {
            document.getElementById('categoryManagerModal').style.display = 'none';
        }

        function openNewBookmarkModal(categoryName) {
            selectedCategoryName = categoryName;
            document.getElementById('newBookmarkForm').reset();
            document.getElementById('newBookmarkModal').style.display = 'flex';
        }

        function closeNewBookmarkModal() {
            document.getElementById('newBookmarkModal').style.display = 'none';
        }

        function openBookmarkManagerModal() {
            selectedCategoryForBookmarks = null;
            renderBookmarkCategoryList();
            document.getElementById('bookmarksList').innerHTML = '';
            document.getElementById('bookmarkManagerModal').style.display = 'flex';
        }

        function closeBookmarkManagerModal() {
            document.getElementById('bookmarkManagerModal').style.display = 'none';
        }

        window.onclick = function(event) {
            const categoryModal = document.getElementById('categoryManagerModal');
            const bookmarkModal = document.getElementById('newBookmarkModal');
            const bookmarkManagerModal = document.getElementById('bookmarkManagerModal');

            if (event.target === categoryModal) closeCategoryManagerModal();
            if (event.target === bookmarkModal) closeNewBookmarkModal();
            if (event.target === bookmarkManagerModal) closeBookmarkManagerModal();
        };

        document.getElementById('newCategoryForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const name = document.getElementById('newCategoryName').value.trim();
            const color = document.getElementById('newCategoryColor').value;
            if (name) {
                categories.push({ id: Date.now(), name: name, color: color, bookmarks: [] });
                saveCategories();
                renderCategories();
                renderCategoryManagementList();
                renderBookmarkCategoryList();
                closeCategoryManagerModal();
            }
        });

        function editCategory(index) {
            const categoryToEdit = categories[index];
            const newName = prompt("Nuevo nombre para la categoría:", categoryToEdit.name);
            if (newName?.trim()) {
                categoryToEdit.name = newName.trim();
                const newColor = prompt("Nuevo color (opcional):", categoryToEdit.color);
                if (newColor) categoryToEdit.color = newColor;
                saveCategories();
                renderCategories();
                renderCategoryManagementList();
                renderBookmarkCategoryList();
            }
        }

        function deleteCategory(index) {
            if (confirm("¿Seguro que quieres eliminar esta categoría?")) {
                categories.splice(index, 1);
                saveCategories();
                renderCategories();
                renderCategoryManagementList();
                renderBookmarkCategoryList();
            }
        }

        function moveCategoryUp(index) {
            if (index &gt; 0) {
                [categories[index], categories[index - 1]] = [categories[index - 1], categories[index]];
                saveCategories();
                renderCategories();
                renderCategoryManagementList();
            }
        }

        function moveCategoryDown(index) {
            if (index &lt; categories.length - 1) {
                [categories[index], categories[index + 1]] = [categories[index + 1], categories[index]];
                saveCategories();
                renderCategories();
                renderCategoryManagementList();
            }
        }

        document.getElementById('newBookmarkForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const title = document.getElementById('bookmarkTitle').value.trim();
            const url = document.getElementById('bookmarkURL').value.trim();
            if (title &amp;&amp; url &amp;&amp; selectedCategoryName) {
                const category = categories.find(cat =&gt; cat.name === selectedCategoryName);
                if (category) {
                    category.bookmarks.push({ title, url });
                    saveCategories();
                    renderCategories();
                    closeNewBookmarkModal();
                }
            }
        });

        function renderBookmarkCategoryList() {
            const list = document.getElementById('bookmarkCategoryList');
            if (!list) return;
            list.innerHTML = '&lt;option value=""&gt;-- Seleccione --&lt;/option&gt;';
            categories.forEach(category =&gt; {
                list.innerHTML += `&lt;option value="${category.name}"&gt;${category.name}&lt;/option&gt;`;
            });
        }

        function selectCategoryForBookmarks(categoryName) {
            selectedCategoryForBookmarks = categoryName;
            renderBookmarkManagementList();
        }

        function renderBookmarkManagementList() {
            const list = document.getElementById('bookmarksList');
            if (!list || !selectedCategoryForBookmarks) return;
            list.innerHTML = '';

            const category = categories.find(cat =&gt; cat.name === selectedCategoryForBookmarks);
            if (!category) return;

            category.bookmarks.forEach((bookmark, index) =&gt; {
                list.innerHTML += `
                    &lt;div class="bookmark-item"&gt;
                        &lt;span&gt;${bookmark.title}&lt;/span&gt;
                        &lt;div class="bookmark-actions"&gt;
                            &lt;button onclick="editBookmark('${selectedCategoryForBookmarks}', ${index})"&gt;&lt;i class="fas fa-edit"&gt;&lt;/i&gt;&lt;/button&gt;
                            &lt;button onclick="deleteBookmark('${selectedCategoryForBookmarks}', ${index})"&gt;&lt;i class="fas fa-trash-alt"&gt;&lt;/i&gt;&lt;/button&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                `;
            });
        }

        function editBookmark(categoryName, index) {
            const category = categories.find(cat =&gt; cat.name === categoryName);
            if (!category) return;
            const bookmark = category.bookmarks[index];

            const newTitle = prompt("Nuevo título:", bookmark.title);
            if (newTitle?.trim()) bookmark.title = newTitle.trim();

            const newUrl = prompt("Nueva URL:", bookmark.url);
            if (newUrl?.trim()) bookmark.url = newUrl.trim();

            saveCategories();
            renderCategories();
            renderBookmarkManagementList();
        }

        function deleteBookmark(categoryName, index) {
            if (!confirm("¿Seguro que quieres eliminar este marcador?")) return;

            const category = categories.find(cat =&gt; cat.name === categoryName);
            if (!category) return;

            category.bookmarks.splice(index, 1);
            saveCategories();
            renderCategories();
            renderBookmarkManagementList();
        }

      function downloadUpdatedHTML() {
        // 1. Construir el HTML *como cadena* (más fácil de manipular)
        let htmlString = `&lt;!DOCTYPE html&gt;
&lt;html lang="es"&gt;
&lt;head&gt;
${document.head.innerHTML}
&lt;/head&gt;
&lt;body&gt;
&lt;div class="container"&gt;
    &lt;header class="header"&gt;
        &lt;h1&gt;&lt;i class="fas fa-tachometer-alt"&gt;&lt;/i&gt; Mi Dashboard Personal&lt;/h1&gt;
        &lt;p class="subtitle"&gt;Organiza tus enlaces favoritos&lt;/p&gt;
    &lt;/header&gt;
    &lt;div class="buttons"&gt;
        &lt;button class="btn btn-primary" onclick="openCategoryManagerModal()"&gt;&lt;i class="fas fa-folder-plus"&gt;&lt;/i&gt; Gestionar Categorías&lt;/button&gt;
        &lt;button class="btn btn-secondary" onclick="openBookmarkManagerModal()"&gt;&lt;i class="fas fa-bookmark"&gt;&lt;/i&gt; Gestionar Marcadores&lt;/button&gt;
        &lt;button class="btn btn-download" onclick="downloadUpdatedHTML()"&gt;&lt;i class="fas fa-download"&gt;&lt;/i&gt; Descargar HTML&lt;/button&gt;
    &lt;/div&gt;
    &lt;main id="bookmarksGrid" class="bookmarks-grid"&gt;`;

        categories.forEach(category =&gt; {
          htmlString += `
          &lt;div class="category" data-category="${category.name}"&gt;
              &lt;div class="category-header" style="background: linear-gradient(45deg, ${category.color}, ${adjustColor(category.color, -20)}); "&gt;
                  &lt;span&gt;${category.name}&lt;/span&gt;
                  &lt;div class="add-icon" onclick="openNewBookmarkModal('${category.name}')"&gt;
                      &lt;i class="fas fa-plus"&gt;&lt;/i&gt;
                  &lt;/div&gt;
              &lt;/div&gt;
              &lt;div class="bookmark-list"&gt;`;
          category.bookmarks.forEach(bookmark =&gt; {
            htmlString += `&lt;a href="${bookmark.url}" class="bookmark" target="_blank"&gt;${bookmark.title}&lt;/a&gt;`;
          });
          htmlString += `&lt;/div&gt;
          &lt;/div&gt;`;
        });

        htmlString += `&lt;/main&gt;
&lt;/div&gt;
&lt;footer class="footer"&gt;
    &lt;p&gt;Creado por ElVarto7 - 2025&lt;/p&gt;
&lt;/footer&gt;
&lt;/body&gt;
&lt;/html&gt;`;

        // 2. Usar DOMParser para convertir la cadena HTML en un documento DOM *seguro*
        const parser = new DOMParser();
        const doc = parser.parseFromString(htmlString, 'text/html');

        // 3. Añadir el script *al nuevo documento*
        const scriptElement = doc.createElement('script');
        scriptElement.textContent = Array.from(document.scripts).map(script =&gt; script.textContent).join('\n');
        doc.body.appendChild(scriptElement); // Añadir el script al *body* del nuevo documento


        // 4. Serializar el documento DOM a una cadena HTML
        const serializer = new XMLSerializer();
        const serializedHTML = serializer.serializeToString(doc);

        // 5. Crear el blob y el enlace de descarga
        const blob = new Blob([serializedHTML], { type: 'text/html' });
        const a = document.createElement('a'); // Usar document.createElement (documento original)
        a.href = URL.createObjectURL(blob);
        a.download = 'mi_dashboard_personal.html';
        document.body.appendChild(a); // Añadir al DOM *antes* de hacer click
        a.click();
        document.body.removeChild(a); // Limpiar
        URL.revokeObjectURL(a.href);
    }

        function adjustColor(color, amount) {
            let usePound = false;
            if (color[0] === "#") {
                color = color.slice(1);
                usePound = true;
            }
            const num = parseInt(color, 16);
            let r = (num &gt;&gt; 16) + amount;
            let g = ((num &gt;&gt; 8) &amp; 0x00FF) + amount;
            let b = (num &amp; 0x0000FF) + amount;
            r = Math.max(Math.min(255, r), 0);
            g = Math.max(Math.min(255, g), 0);
            b = Math.max(Math.min(255, b), 0);
            const newColor = (r &lt;&lt; 16) | (g &lt;&lt; 8) | b;
            return (usePound ? "#" : "") + newColor.toString(16).padStart(6, '0');
        }
    </script></body></html>
